<!doctype html>
<html lang="fr">

<head>
	<meta charset="UTF-8">
	<script type="text/javascript" src="generate_svg_boxes.js"></script>
</head>

<body>
	<a id="filesvg" >
	</a>
	<svg id="svg" width="600" height="300" stroke="#ff0000" stroke="blue" fill="#ffffff" fill-opacity="0" xml="outermost <svg> element needs to setup SVG and its namespace: xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve">
		<!-- m : moveto, then the value cuple x,y gives us the next position to go to, and then z to return to the starting point -->
		<!--<path id="path1" transform="translate(10,10)"   d="m 10,10 100,0 0,50 -100,0 z"/> -->
		<!--<path id="path2" transform="translate(100,100)" d="m 10,10 100,0 0,50 -100,0 z"/>-->
	</svg>
	<button onclick="generate_svg_file()">Generate svg file</button>
	<button onclick="generate_elements()">Test Generate SVG elements</button>
	<button onclick="tests()">Test</button>
	
	<script type="text/javascript">
		// encode the data from the svg tag into URI data, and then set those information directly to the a tag.
		// then we use the magic function click that simulate a human click on this a tag, which open the download yes/no window.
		function generate_svg_file() {
			// Use XMLSerializer to convert the DOM to a string
			var s = new XMLSerializer();
			var d = document.getElementById("svg");
			var str = s.serializeToString(d); // the svg tag with its contents 
			// and then btoa can convert that to base64
			var encodedData = "data:image/svg+xml;base64," + window.btoa(str); 
			// we set the uri content
			document.getElementById("filesvg").setAttribute("href", encodedData);
			// we set the file name downloaded
			document.getElementById("filesvg").setAttribute("download", "thismustbethebest.svg");
			// our a tag is hidden, so we use the click function as we would click on it usualy
			document.getElementById("filesvg").click();
		}		
		
		// tests ok : append path element to the svg tag
		function generate_elements() {
			var svg = document.getElementById("svg");
			var newpath = document.createElementNS(svg.namespaceURI,"path");  
			newpath.setAttribute("transform", "translate(100,10)"); 
			newpath.setAttribute("d", "m 10,10 100,0 0,50 -100,0 z");  
			svg.appendChild(newpath);
		}
	</script>
</body>

</html>